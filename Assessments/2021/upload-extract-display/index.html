



<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Engineering Internship Assessment</title>
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="Digi-X Internship Committee" />

  <link rel="stylesheet" href="style.css?v=1.0" />
  <link rel="stylesheet" href="custom.css?v=1.0" />

</head>

<body>

    <div class="top-wrapper">
        <img src="https://assets.website-files.com/5cd4f29af95bc7d8af794e0e/5cfe060171000aa66754447a_n-digi-x-logo-white-yellow-standard.svg" alt="digi-x logo" height="70" />
        <h1>Engineering Internship Assessment</h1>
    </div>

    <!-- <div class="instruction-wrapper">
        <h2>What you need to do?</h2>
        <h3 style="margin-top:31px;">Using this HTML template, create a page that can:</h3>
        <ol>
            <li><b class="yellow">Upload</b> a zip file - containing 5 images (Cats, or Dogs, or even Pokemons)</li>
            <li>after uploading, <b class="yellow">Extract</b> the zip to get the images </li>
            <li><b class="yellow">Display</b> the images on this page</li>
        </ol>

        <h2 style="margin-top:51px;">The rules?</h2>
        <ol>
            <li>May use <b class="yellow">any programming language/script</b>. The simplest the better *wink*</li>
            <li><b class="yellow">Best if this project could be hosted</b></li>
            <li><b class="yellow">If you are not hosting</b>, please provide a video as proof (GDrive video link is ok)</li>
            <li><b class="yellow">Submit your code</b> by pushing to your own github account, and share the link with us</li>
        </ol>
    </div> -->

    <!-- DO NO REMOVE CODE STARTING HERE -->
    <div class="display-wrapper">
        <h2 style="margin-top:51px;">My images</h2>
        <div class="append-images-here">
            <p>No image found. Your extracted images should be here.</p>
            <!-- THE IMAGES SHOULD BE DISPLAYED INSIDE HERE -->
            <form method="POST"  enctype="multipart/form-data">
                <label>Upload ZIP file</label>
                <br>
                <input type="file" name="zip_file"/>
                <br/>
                <input type="submit" name = "btn_zip" value="Upload ZIP" />
                
                <?php 
                
                    if(isset($output))  
                    {  
                         echo $output;  
                    }  
                ?>
            </form>
        </div>
    </div>
    <!-- DO NO REMOVE CODE UNTIL HERE -->

</body>
</html>

<?php  
 if(isset($_POST["btn_zip"]))  
 {  
    //Upload zip file

    $zip = new ZipArchive;
    // $file = $zip->open('images2.zip');
    $file = $_FILES['zip_file'];
    $fileName = $_FILES['zip_file']['name'];
    $fileType = $_FILES['zip_file']['type'];
    $fileError = $_FILES['zip_file']['error'];
    $fileSize = $_FILES['zip_file']['size'];

    $fileArray = explode('.', $fileName);
    $fileExt = strtolower(end($fileArray));

    $acceptedformat = array('zip','jpg', 'jpeg', 'PNG', 'jfif');

    if(in_array($fileExt, $acceptedformat)){
        $fileNameNew = uniqid('', true).".".$fileExt;
        $fileDestination = 'imgupload/'.$fileNameNew;
        move_uploaded_file($fileTmpName, $fileDestination);
        
    }else{
        echo "Wrong format";
    }
    // Zip File Name
    if ($file === TRUE) {
  
        // Unzip Path
        $zip->extractTo('C:/wamp64/www/dx-intern-assessment/Assessments/2021/upload-extract-display/');
        $file = $zip->close('images2.zip');
        echo 'Unzipped Process Successful!';
    } 
    else {
    echo 'Unzipped Process failed';
    }
    //Extract zip file to a folder

    //Read image files from folder by pointing to folder Name
    $dir_path = "imgupload/";
    $extensions_array = array('jpg','png','jpeg', 'jfif');

    if(is_dir($dir_path))
    {
    $files = scandir($dir_path);
    
    for($i = 0; $i < count($files); $i++)
    {
        if($files[$i] !='.' && $files[$i] !='..')
        {
            // get file name
            echo "File Name -> $files[$i]<br>";
            
            // get file extension
            $file = pathinfo($files[$i]);
            $extension = $file['extension'];
            echo "File Extension-> $extension<br>";
            
           // check file extension
            if(in_array($extension, $extensions_array))
            {
            // show image
            echo "<img src='$dir_path$files[$i]' style='width:100px;height:100px;'><br>";
            }
        }
    }
}
 }  
 ?>  